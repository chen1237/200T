## 欧拉函数（复变函数） 五边形数 分割函数

#### 欧拉函数（复变函数）

<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h0ml6uvjl7j20di04i0sn.jpg" alt="image-20220325224715174" style="zoom:50%;" />

将这个式子展开

<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h0ml7kxy5mj20jg04uwei.jpg" alt="image-20220325224807676" style="zoom:50%;" />

其中 $x$ 的次数，<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h0ml7nafxfj204402oq2q.jpg" alt="image-20220325225009298" style="zoom:50%;" />，为[广义五边形数](https://zh.wikipedia.org/wiki/廣義五邊形數)

将得到的所有项按升幂排列，得到：

<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h0ml7iyu02j20re020q2w.jpg" alt="image-20220325225231363" style="zoom:50%;" />

#### 分割函数

**定义**：将正整数 $n$ 拆分为若干个正整数的和（允许同一个数使用多次，这里的拆分是无序的，即 1+2 和 2+1 等价）的方案数。

欧拉函数的倒数是**划分数（分割函数）**的**生成函数**：

<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h0ml7jyeegj20qo04i74h.jpg" alt="image-20220325232231460" style="zoom:50%;" />

其中 $p(i)$ 为 $i$ 的分割函数

有

<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h0ml7mes1rj210g058t91.jpg" alt="image-20220325234204155" style="zoom:50%;" />

展开得到递推式

<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h0ml7kgk1sj20zm02imx8.jpg" alt="image-20220325234251753" style="zoom:50%;" />

##### 分割函数的代码实现<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h0ml7i9z8vj205401wt8i.jpg" alt="image-20220326000415837" style="zoom: 33%;" />

[P6189 [NOI Online #1 入门组] 跑步](https://www.luogu.com.cn/problem/P6189)

```cpp
#include<bits/stdc++.h>
#define FOR(i,a,b) for(int i=(a);i<=(b);++i)
using namespace std;

const int maxn (1e5+7);
const int INF (1<<30);

long long f[maxn];

inline int a(int x){
    return (3*x*x-x)/2;
}

int main(){
    int n,p;
    cin>>n>>p;
    f[0]=1;
    FOR(i,1,n){
        FOR(j,1,INF){
            int x=a(j),y=a(-j);
            if(x<=i) f[i]=((f[i]+(j&1?1:-1)*f[i-x])%p+p)%p;
            //f(i)=f(i)+(-1)^(j+1)*f(i-x)
            if(y<=i) f[i]=((f[i]+(j&1?1:-1)*f[i-y])%p+p)%p;
            if(x>i or y>i) break;
        }
    }
    cout<<f[n];
    return 0;
}
```



#### 五边形数

**五边形数**是能排成[五边形](https://zh.wikipedia.org/wiki/五邊形)的[多边形数](https://zh.wikipedia.org/wiki/多邊形數)。

![image-20220325230706580](https://tva1.sinaimg.cn/large/e6c9d24ely1h0ml7luc2cj20ws0cwmxt.jpg)

通项公式：<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h0ml7jg4raj209i03gdfo.jpg" alt="image-20220325231030671" style="zoom:50%;" />

**广义五边形数**的公式和五边形数相同，只是 n 可以为负数和零，**n 依序为0, 1, -1, 2, -2, 3, -3, 4...**，广义五边形数也可以用下式表示：

<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h0ml7mu906j209k03smx0.jpg" alt="image-20220325231233477" style="zoom:50%;" />

**n 依序为0, 1, 2, 3, 4, 5, 6, 7, 8...**

其产生的数列如下：

0, 1, 2, 5, 7, 12, 15, 22, 26...