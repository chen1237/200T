<!doctype html>
<html>
<head>
<meta charset='UTF-8'><meta name='viewport' content='width=device-width initial-scale=1'>
<title>欧拉函数（复变函数） 五边形数</title>
</head>
<body><h2 id='欧拉函数复变函数）-五边形数-分割函数'>欧拉函数（复变函数） 五边形数 分割函数</h2>
<h4 id='欧拉函数复变函数）'>欧拉函数（复变函数）</h4>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h0ml6uvjl7j20di04i0sn.jpg" alt="image-20220325224715174" style="zoom:50%;" /></p>
<p>将这个式子展开</p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h0ml7kxy5mj20jg04uwei.jpg" alt="image-20220325224807676" style="zoom:50%;" /></p>
<p>其中 <mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="1.294ex" height="1.025ex" role="img" focusable="false" viewBox="0 -442 572 453" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.025ex;"><defs><path id="MJX-5-TEX-I-1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D465" xlink:href="#MJX-5-TEX-I-1D465"></use></g></g></g></svg></mjx-container><script type="math/tex">x</script> 的次数，<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h0ml7nafxfj204402oq2q.jpg" alt="image-20220325225009298" style="zoom:50%;" />，为<a href='https://zh.wikipedia.org/wiki/廣義五邊形數'>广义五边形数</a></p>
<p>将得到的所有项按升幂排列，得到：</p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h0ml7iyu02j20re020q2w.jpg" alt="image-20220325225231363" style="zoom:50%;" /></p>
<h4 id='分割函数'>分割函数</h4>
<p><strong>定义</strong>：将正整数 <mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="1.357ex" height="1.025ex" role="img" focusable="false" viewBox="0 -442 600 453" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.025ex;"><defs><path id="MJX-6-TEX-I-1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D45B" xlink:href="#MJX-6-TEX-I-1D45B"></use></g></g></g></svg></mjx-container><script type="math/tex">n</script> 拆分为若干个正整数的和（允许同一个数使用多次，这里的拆分是无序的，即 1+2 和 2+1 等价）的方案数。</p>
<p>欧拉函数的倒数是<strong>划分数（分割函数）</strong>的<strong>生成函数</strong>：</p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h0ml7jyeegj20qo04i74h.jpg" alt="image-20220325232231460" style="zoom:50%;" /></p>
<p>其中 <mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="3.679ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 1626 1000" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.566ex;"><defs><path id="MJX-7-TEX-I-1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path><path id="MJX-7-TEX-N-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path id="MJX-7-TEX-I-1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path><path id="MJX-7-TEX-N-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D45D" xlink:href="#MJX-7-TEX-I-1D45D"></use></g><g data-mml-node="mo" transform="translate(503,0)"><use data-c="28" xlink:href="#MJX-7-TEX-N-28"></use></g><g data-mml-node="mi" transform="translate(892,0)"><use data-c="1D456" xlink:href="#MJX-7-TEX-I-1D456"></use></g><g data-mml-node="mo" transform="translate(1237,0)"><use data-c="29" xlink:href="#MJX-7-TEX-N-29"></use></g></g></g></svg></mjx-container><script type="math/tex">p(i)</script> 为 <mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="0.781ex" height="1.52ex" role="img" focusable="false" viewBox="0 -661 345 672" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.025ex;"><defs><path id="MJX-8-TEX-I-1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D456" xlink:href="#MJX-8-TEX-I-1D456"></use></g></g></g></svg></mjx-container><script type="math/tex">i</script> 的分割函数</p>
<p>有</p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h0ml7mes1rj210g058t91.jpg" alt="image-20220325234204155" style="zoom:50%;" /></p>
<p>展开得到递推式</p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h0ml7kgk1sj20zm02imx8.jpg" alt="image-20220325234251753" style="zoom:50%;" /></p>
<h5 id='分割函数的代码实现'>分割函数的代码实现<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h0ml7i9z8vj205401wt8i.jpg" alt="image-20220326000415837" style="zoom: 33%;" /></h5>
<p><a href='https://www.luogu.com.cn/problem/P6189'>P6189 [NOI Online #1 入门组] 跑步</a></p>
<pre><code class='language-cpp' lang='cpp'>#include&lt;bits/stdc++.h&gt;
#define FOR(i,a,b) for(int i=(a);i&lt;=(b);++i)
using namespace std;

const int maxn (1e5+7);
const int INF (1&lt;&lt;30);

long long f[maxn];

inline int a(int x){
    return (3*x*x-x)/2;
}

int main(){
    int n,p;
    cin&gt;&gt;n&gt;&gt;p;
    f[0]=1;
    FOR(i,1,n){
        FOR(j,1,INF){
            int x=a(j),y=a(-j);
            if(x&lt;=i) f[i]=((f[i]+(j&amp;1?1:-1)*f[i-x])%p+p)%p;
            //f(i)=f(i)+(-1)^(j+1)*f(i-x)
            if(y&lt;=i) f[i]=((f[i]+(j&amp;1?1:-1)*f[i-y])%p+p)%p;
            if(x&gt;i or y&gt;i) break;
        }
    }
    cout&lt;&lt;f[n];
    return 0;
}
</code></pre>
<p>&nbsp;</p>
<h4 id='五边形数'>五边形数</h4>
<p><strong>五边形数</strong>是能排成<a href='https://zh.wikipedia.org/wiki/五邊形'>五边形</a>的<a href='https://zh.wikipedia.org/wiki/多邊形數'>多边形数</a>。</p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h0ml7luc2cj20ws0cwmxt.jpg" referrerpolicy="no-referrer" alt="image-20220325230706580"></p>
<p>通项公式：<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h0ml7jg4raj209i03gdfo.jpg" alt="image-20220325231030671" style="zoom:50%;" /></p>
<p><strong>广义五边形数</strong>的公式和五边形数相同，只是 n 可以为负数和零，<strong>n 依序为0, 1, -1, 2, -2, 3, -3, 4...</strong>，广义五边形数也可以用下式表示：</p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h0ml7mu906j209k03smx0.jpg" alt="image-20220325231233477" style="zoom:50%;" /></p>
<p><strong>n 依序为0, 1, 2, 3, 4, 5, 6, 7, 8...</strong></p>
<p>其产生的数列如下：</p>
<p>0, 1, 2, 5, 7, 12, 15, 22, 26...</p>
</body>
</html>